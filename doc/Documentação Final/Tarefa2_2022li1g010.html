<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Tarefa2_2022li1g010</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption empty">&nbsp;</span><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Pedro Figueiredo Pereira &lt;a104082@alunos.uminho.pt&gt;<br />Jorge Ubaldo Rodrigues Ferreira &lt;a104096@alunos.uminho.pt&gt;</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr></table><p class="caption">Tarefa2_2022li1g010</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Fun&#231;&#227;o main</a></li><li><a href="#g:2">Fun&#231;&#245;es auxiliares</a><ul><li><a href="#g:3">Fun&#231;&#227;o <code>geradorVelocidadeRio</code></a></li><li><a href="#g:4">Fun&#231;&#227;o <code>escolheTerrenoValido</code></a></li><li><a href="#g:5">Fun&#231;&#227;o <code>criaLinhaObstaculosValida</code></a></li><li><a href="#g:6">Fun&#231;&#227;o <code>proximosTerrenosValidos</code></a></li><li><a href="#g:7">Fun&#231;&#227;o <code>proximosObstaculosValidosAux</code></a></li></ul></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>M&#243;dulo para a realiza&#231;&#227;o da Tarefa 2 do projeto de LI1 em 2022/23.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:estendeMapa">estendeMapa</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Int -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a></li><li class="src short"><a href="#v:geradorVelocidadeRio">geradorVelocidadeRio</a> :: <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> -&gt; Int -&gt; Int</li><li class="src short"><a href="#v:escolheTerrenoValido">escolheTerrenoValido</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Int -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a></li><li class="src short"><a href="#v:criaLinhaObstaculosValida">criaLinhaObstaculosValida</a> :: Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; StdGen -&gt; Int -&gt; Int -&gt; Int -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</li><li class="src short"><a href="#v:proximosTerrenosValidos">proximosTerrenosValidos</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; [<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>]</li><li class="src short"><a href="#v:proximosObstaculosValidosAux">proximosObstaculosValidosAux</a> :: Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Fun&#231;&#227;o main</h1></a><div class="top"><p class="src"><a id="v:estendeMapa" class="def">estendeMapa</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Int -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> <a href="#v:estendeMapa" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g010.html#v:estendeMapa" title="Tarefa2_2022li1g010">estendeMapa</a></code> recebe um <strong>Mapa</strong> e acrescenta um linha, de forma a promover uma gera&#231;&#227;o cont&#237;nua do mesmo.
Esta recorre as fun&#231;&#245;es auxiliares <code><a href="Tarefa2_2022li1g010.html#v:escolheTerrenoValido" title="Tarefa2_2022li1g010">escolheTerrenoValido</a></code>, <code><a href="Tarefa2_2022li1g010.html#v:criaLinhaObstaculosValida" title="Tarefa2_2022li1g010">criaLinhaObstaculosValida</a></code> e a fun&#231;&#227;o <code><a href="Tarefa2_2022li1g010.html#v:geradorVelocidadeRio" title="Tarefa2_2022li1g010">geradorVelocidadeRio</a></code>, para desta forma determinar o novo Mapa gerado nesta fun&#231;&#227;o. </p><pre>estendeMapa :: Mapa -&gt; Int -&gt; Mapa
estendeMapa (Mapa largura linhas<code>(h</code>(terreno1, obs1):t)) numero | terreno == Rio 0 = (Mapa largura ((Rio vr, obs):(terreno1, obs1):t))
                                                                | terreno == Estrada 0 = (Mapa largura ((Estrada v, obs):h:t))
                                                                | terreno == Relva = (Mapa largura ((Relva, obs):h:t))
    where
        terreno = escolheTerrenoValido (Mapa largura linhas) numero
        obs = criaLinhaObstaculosValida largura (terreno, []) (mkStdGen numero) 0 0 0
        v = velocidadesPossiveis !! (mod numero (length velocidadesPossiveis))
            where 
                velocidadesPossiveis = (delete 0 [(-3)..(3)])
        vr = geradorVelocidadeRio terreno1 numero  
</pre><h2>Exemplo de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>estendeMapa (Mapa 2 [(Rio 2, [Tronco, Nenhum]), (Estrada 2, [Carro, Nenhum])]) 89 = Mapa 2 [(Relva,[Nenhum,Nenhum]),(Rio 2,[Tronco,Nenhum]),(Estrada 2,[Carro,Nenhum])]
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>estendeMapa (Mapa 2 [(Rio 2, [Tronco, Nenhum]), (Estrada 2, [Carro, Nenhum])]) 34 = Mapa 2 [(Rio (-4),[Nenhum,Tronco]),(Rio 2,[Nenhum,Tronco]),(Estrada 2,[Carro,Nenhum])]
</code></strong></pre><h2>Propriedades:</h2><pre>Recebe sempre um Mapa v&#225;lido.</pre><pre>Cria sempre uma linha v&#225;lida.</pre></div></div><a href="#g:2" id="g:2"><h1>Fun&#231;&#245;es auxiliares</h1></a><a href="#g:3" id="g:3"><h2>Fun&#231;&#227;o <code>geradorVelocidadeRio</code></h2></a><div class="top"><p class="src"><a id="v:geradorVelocidadeRio" class="def">geradorVelocidadeRio</a> :: <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> -&gt; Int -&gt; Int <a href="#v:geradorVelocidadeRio" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g010.html#v:geradorVelocidadeRio" title="Tarefa2_2022li1g010">geradorVelocidadeRio</a></code> recebe um <strong>Terreno</strong> e um <strong>Inteiro</strong> (n&#250;mero aleat&#243;rio) e d&#225; como resultado um <strong>Inteiro</strong> (velocidade).
Esta fun&#231;&#227;o servir&#225; para determinar uma velocidade v&#225;lida com base na compara&#231;&#227;o com o caso anterior.</p><pre>geradorVelocidadeRio :: Terreno -&gt; Int -&gt; Int 
geradorVelocidadeRio (Rio vr) numero | vr &lt; 0 = (mod numero 3) + 1 
                                     | otherwise = ((-1) * (mod numero 3)) - 1
geradorVelocidadeRio _ numero = (mod numero 3) + 1
</pre><h2>Propriedades:</h2><pre>Verifica o valor da velocidade do terreno anterior no caso de ser Rio.</pre><pre>Produz um valor de velocidade aleat&#243;rio, com sentido oposto ao do Rio anterior.</pre></div></div><a href="#g:4" id="g:4"><h2>Fun&#231;&#227;o <code>escolheTerrenoValido</code></h2></a><div class="top"><p class="src"><a id="v:escolheTerrenoValido" class="def">escolheTerrenoValido</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Int -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> <a href="#v:escolheTerrenoValido" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g010.html#v:escolheTerrenoValido" title="Tarefa2_2022li1g010">escolheTerrenoValido</a></code> recebe um <strong>Mapa</strong> e um <strong>Int</strong> (n&#250;mero aleat&#243;rio) e d&#225; como resultado um <strong>Terreno</strong>, o qual corresponde ao terreno da nova linha.
Desta forma, chama-se a fun&#231;&#227;o auxiliar <code><a href="Tarefa2_2022li1g010.html#v:proximosTerrenosValidos" title="Tarefa2_2022li1g010">proximosTerrenosValidos</a></code> (que entrega &#224; fun&#231;&#227;o a lista de possibilidades de Terrenos poss&#237;veis).</p><pre>escolheTerrenoValido :: Mapa -&gt; Int -&gt; Terreno
escolheTerrenoValido (Mapa largura linhas) numero = listaTerrenosValidos !! (mod numero (length listaTerrenosValidos)) 
        where
            listaTerrenosValidos = proximosTerrenosValidos (Mapa largura linhas)  
</pre><h2>Exemplo de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>escolheTerrenoValido (Mapa 2 [(Rio 2, [Tronco, Nenhum]), (Estrada 2, [Carro, Nenhum])]) 34 = Rio 0
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>escolheTerrenoValido (Mapa 2 [(Relva, [Arvore, Nenhum]), (Estrada 2, [Carro, Nenhum])]) 57 = Estrada 0
</code></strong></pre></div></div><a href="#g:5" id="g:5"><h2>Fun&#231;&#227;o <code>criaLinhaObstaculosValida</code></h2></a><div class="top"><p class="src"><a id="v:criaLinhaObstaculosValida" class="def">criaLinhaObstaculosValida</a> :: Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; StdGen -&gt; Int -&gt; Int -&gt; Int -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] <a href="#v:criaLinhaObstaculosValida" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g010.html#v:criaLinhaObstaculosValida" title="Tarefa2_2022li1g010">criaLinhaObstaculosValida</a></code> recebe um <strong>Inteiro</strong> (largura do mapa), um <strong>Tuplo</strong> (linha representada por (terreno, obs)), um <strong>StdGen</strong> (n&#250;mero aleat&#243;rio) e um <strong>Inteiro</strong> (acumulador de controlo) e d&#225; como resultado uma <strong>[Obstaculo]</strong>, a qual corresponde &#224; lista de obst&#225;culos da nova linha.
Desta forma, chama-se a fun&#231;&#227;o auxiliar <code>proximosObstaculosValidos</code> (que entrega &#224; fun&#231;&#227;o a lista de possibilidades de Obst&#225;culos poss&#237;veis).</p><pre>criaLinhaObstaculosValida :: Int -&gt; (Terreno, [Obstaculo]) -&gt; StdGen -&gt; Int -&gt; Int -&gt; Int -&gt; [Obstaculo]
criaLinhaObstaculosValida largura (terreno, obs) numero acc contacarros contatroncos 
        | largura &lt;= acc = []
        | acc == 0 = Nenhum : criaLinhaObstaculosValida largura (terreno, obs) proxnum (acc + 1) 0 0
        | terreno == Relva = obstaculos : criaLinhaObstaculosValida largura (terreno, obs) proxnum (acc + 1) 0 0
        | (obstaculos == Carro) &amp;&amp; (contacarros &lt; 3) = obstaculos : criaLinhaObstaculosValida largura (terreno, obs) proxnum (acc + 1) (contacarros + 1) contatroncos
        | (obstaculos == Tronco) &amp;&amp; (contatroncos &lt; 5) = obstaculos : criaLinhaObstaculosValida largura (terreno, obs) proxnum (acc + 1) contacarros (contatroncos + 1)
        | otherwise = Nenhum : criaLinhaObstaculosValida largura (terreno, obs) proxnum (acc + 1) 0 0
                         where 
                             obstaculos = listaObstaculosValidos !! (mod num (length listaObstaculosValidos))
                                    where
                                        listaObstaculosValidos = proximosObstaculosValidosAux largura (terreno, obs)
                             (num, proxnum) = next numero 
</pre><h2>Exemplo de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>criaLinhaObstaculosValida 2 (Rio 2, []) 37 1 = [Nenhum, Tronco]
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>criaLinhaObstaculosValida 4 (Relva, []) 48 1 = [Nenhum, Arvore, Arvore, Nenhum]
</code></strong></pre></div></div><a href="#g:6" id="g:6"><h2>Fun&#231;&#227;o <code>proximosTerrenosValidos</code></h2></a><div class="top"><p class="src"><a id="v:proximosTerrenosValidos" class="def">proximosTerrenosValidos</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; [<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>] <a href="#v:proximosTerrenosValidos" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g010.html#v:proximosTerrenosValidos" title="Tarefa2_2022li1g010">proximosTerrenosValidos</a></code> recebe um <strong>Mapa</strong>  e d&#225; como resultado uma <strong>[Terreno]</strong>, a qual corresponde &#224; lista de terrenos poss&#237;veis.
Esta fun&#231;&#227;o recorre ao pattern matching para criar uma lista totalmente v&#225;lida.</p><pre>proximosTerrenosValidos :: Mapa -&gt; [Terreno]
proximosTerrenosValidos (Mapa _ []) = [Estrada 0, Rio 0, Relva]
proximosTerrenosValidos (Mapa largura ((Rio _, _):(Rio _, _):(Rio _, _):(Rio _, _):t)) = [Estrada 0, Relva]
proximosTerrenosValidos (Mapa largura ((Estrada _, _):(Estrada _, _):(Estrada _, _):(Estrada _, _):(Estrada _, _):t)) = [Rio 0, Relva]
proximosTerrenosValidos (Mapa largura ((Relva, _):(Relva, _):(Relva, _):(Relva, _):(Relva, _):t)) = [Rio 0, Estrada 0]
proximosTerrenosValidos (Mapa _ linhas) = [Estrada 0, Rio 0, Relva]
</pre><h2>Exemplo de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>proximosTerrenosValidos (Mapa 2 [(Rio 2, [Tronco, Nenhum]), (Estrada 2, [Carro, Nenhum])]) = [Estrada 0, Rio 0, Relva]
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>proximosTerrenosValidos (Mapa 2 [(Estrada (-2), [Nenhum, Carro]), (Estrada 2, [Nenhum, Carro]), (Estrada (-2), [Nenhum, Carro]), (Estrada 2, [Nenhum, Carro]), (Estrada (-2), [Nenhum, Carro])]) = [Rio 0, Relva]
</code></strong></pre></div></div><a href="#g:7" id="g:7"><h2>Fun&#231;&#227;o <code>proximosObstaculosValidosAux</code></h2></a><div class="top"><p class="src"><a id="v:proximosObstaculosValidosAux" class="def">proximosObstaculosValidosAux</a> :: Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] <a href="#v:proximosObstaculosValidosAux" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code>proximosObstaculosValidos</code> recebe um <strong>Inteiro</strong> (largura do mapa) e um <strong>Tuplo</strong> (linha representada por (terreno, obs)) e d&#225; como resultado uma <strong>[Obstaculo]</strong>, a qual corresponde &#224; lista de obst&#225;culos poss&#237;veis.
Desta forma, determina -se a lista de obst&#225;culos (que entrega &#224; fun&#231;&#227;o a lista de possibilidades de Obst&#225;culos poss&#237;veis geral).</p><pre>proximosObstaculosValidosAux :: Int -&gt; (Terreno, [Obstaculo]) -&gt; [Obstaculo]
proximosObstaculosValidosAux largura (Rio _, obs) = [Tronco, Nenhum]
proximosObstaculosValidosAux largura (Estrada _, obs) = [Carro, Nenhum]
proximosObstaculosValidosAux largura (Relva, obs) = [Nenhum, Arvore]
</pre><h2>Exemplo de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>proximosObstaculosValidos 2 (Rio 2, []) = [Tronco, Nenhum]
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>proximosObstaculosValidos 2 (Rio 2, [Tronco, Nenhum]) = []
</code></strong></pre></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.26.0</p></div></body></html>